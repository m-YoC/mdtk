
# TODO

- v0.1.0以降
    - [x] version表示オプション追加 (--version, -v)
        - version情報は外部ファイルに`VERSION=xx.yy.zz`の形で記載してgo:embedで読み込む
    - [x] scriptを全部読み込んでバイナリで保持しておく.cache機能
    - [x] command helpとmarkdown helpを外部ファイルに出してgo:embedで読み込むように変更
    - [x] helpのPAGER表示 (今のところ長くなっているmarkdown helpのみ)
    - [x] PAGER表示の拡張
        - cmd helpとtask helpも
        - 改行数をカウントして、長くなったらPAGER表示に自動的に切り替わるようにする
- v0.2.0以降
    - [x] scriptの書き出し用にdebugとは別に生成されたスクリプトを標準出力に出すだけのオプションを用意する
        - 実行はされない
        - [x] 変数に`{$}`を入れると位置パラメータ(positional parameter) `$1 ~ $9`が順番に入るようにする
    - [x] 指定グループのタスクヘルプだけ見れるようにする
    - [x] shorthandオプションをまとめて書けるように変更
        - `-abc`
    - [x] stdoutに出力しないquietモードを用意する
- v0.3.0以降
    - [ ] group名の衝突を回避する手段を実装する
        - taskfile読み込み時にaliasを付けられると言い？
        - そもそもmdtk in mdtkで読み込めば別データ扱いで管理できるのでいらないかもしれない
    - [x] pager表示を調整する
        - pager表示しなくてもいいようにする
        - PAGER環境変数がなければ何もしないようにするべき？
        - 起動行数指定もいるため、コンフィグファイルで変えられるようにするべき
    - [ ] change color
        - config?
    - [x] configファイルの読み込み、デフォルトコンフィグの書き出し
    - [x] mdtklibファイルの読み込みと書き出し機能
        - cacheと同じように構造体で保持するが、publicタスクを全て展開し、privateタスクは消去する
        - cacheとは異なり.mdtklibファイルを`--file`オプションで直接指定する。読み込めなければ失敗する
            - mdtk in mdtkで使用することを想定
        - FilePathデータは削除されている
        - cacheと異なり自動更新はされない
        - 読み込み時のコストを考えるとコンパクトなmdtklibを複数作成した方がいい
    - [x] コマンドオプションの調整
- v0.4.0以降
    - [x] コードブロックの頭に一部の言語エイリアスを書けるように変更
        - ~*3 sh task::hello
        - のshなどを許容する。初期状態ではsh, shell, bash, zsh
    - [x] scriptの頭に付けるsetもconfigで調節できるように
    - [x] argsの分離文字に`=`だけでなく`:`も使えるように
- v0.4.1以降
    - [x] embedded comment: descの追加
        - task helpで追加説明を行う。タスク名定義行で説明がない場合は行圧縮する
    - [x] bugfix: shellの初期値が`bash`になってたのを`/bin/bash`に変更
        - シバンに埋め込んだときに上手く動かなかったため
    - [x] 視認性のためにタスク名定義行のdesc前に1つ以上の連続した`-`を入れられるようにした
        - 表示はされない
        - taskname及びdescの間にスペースは挟むこと
        - `bash task::hello -- description`
- v0.4.2以降
    - [x] taskconfig:group-order機能
        - groupのtask helpでの並び順をint型の数値で制御する。数値が大きいほど上になる
        - 未記入のgroupは0
        - 同じ数値のgroupは辞書順
    - [x] groupの一覧だけ表示する機能
- v0.5.0以降
    - [x] 関数化して読み込むembedded commentを作成
        - `#func> funcname group:task -- args...`
- v0.5.1以降
    - [x] execの出力がストリーム出力に対応していなかったので修正
        - 全部終わってから書き出していた
- v0.5.2以降
    - [x] mdtkconfigにnestsizeを指定する項目を増やす
    - [x] tar.gzの作成をamd64とarm64で別にする
    - [x] 標準入力を受け付けなかったバグを修正
- v0.5.3以降
    - [x] 属性(`attribute`)をつけれるようにする
        - `~~~sh task::t -- description`
            - `description = [attribute...] xxxxxxx`
            - descriptionの一部として扱う
            - descriptionの最初に記述する
            - 当然無くてもいい
            - 大文字と小文字を区別しない(内部的には全て小文字になる)
        - `hidden`属性をつけていたら公開タスクでもタスクヘルプで見えないようにする
            - group名を非公開に変えてしまうと他のタスクからアクセスできなくなる可能性があるため
            - ただの非公開扱いなので`-a`をつけたら見える
    - [x] private groupを強制的にhidden属性を付けるようにする
            - hiddenのチェックで一元管理できるようにする
    - [x] `set -e` 除去
    - [x] bugfix
    - [x] attr `t`, `b`でタスクヘルプにおけるタスクの順番を若干制御できる
        - t: top, b: bottom
    - [ ] 属性を他のことに利用できないか？
        - `deprecated`: 削除予定につける
        - embedded commentで取り出せるようにする
            - `#attr> g:t attr` -> `true or false`
    - [x] キャッシュファイルの処理周りをgoroutine化して若干の並行処理
    - [x] `#task>`の`@`の仕様を逆にする
    - [x] `--run-in-filedir`オプションを追加
        - カレントディレクトリではなく読み込んだタスクファイルの存在するディレクトリでタスクを実行する
    - [x] shell以外のコードも読み込めるようにする
        - Langを保存
            - shell系はまとめてSHELLとする
        - configでacceptable_sub_langsを追加
        - LangがSHELLでなかったら専用のGetTaskになる
            - `#embed>`と`#config> once`しか作用しない
        - 実行はされず強制的に--scriptになる。正確にはシバンなどを追加しない--no-head-script
        - 強制的にhidden扱いになる
            - タスクヘルプに表示するときはLangも出す
        - ***スクリプト内で別の言語を埋め込むことはあるので、Langでの制約は特に付けないものとする***
- v0.6.0以降
    - [x] windowsでの動作確認
        - powershell terminal環境下においてWSL bashが上手く動作しなかった
        - `$`で始まる変数がシングルクォートで囲っても勝手に変換されてしまう模様
        - Git Bashのterminal, WSLに一度ログインしてからのbash terminalなどでは問題無し
        - 一度ファイルに書き出してそちらを実行するようにすれば問題無し
        - `\$`に置換すれば動作することが判明　なんでなんだ・・・
            - `$`のままで実行できるかの識別関数を作成
            - Ubuntu環境にpwshをインストールし同様の事を行ったところ, `$`のままで実行できた
            - `bash -c 'x=Hello; echo $x'` => `$`のままで実行できるなら`Hello`とでる
            - Windowsのpowershell環境上のWSL Bashに限り出来ない
    - [x] tmpfileを一時的に保存して実行するモードを実装
    - [x] powershellを実行できるように構造を整理
    - [x] 各タスクが書かれているファイルのパス/ディレクトリを表示するオプションを追加
        - .mdtklibはパスが削除されるため利用不可
    - [x] `--run-in-filedir`オプションを`--File`に変更(shorthandは`-F`)
    - [x] タスク名が衝突したときの優先権を設定する属性を追加
        - 名前は検討する -> `priority`
        - `priority:N` みたいな感じで整数を設定できるようにする。0が通常と同じ
        - こっちを追加したら上の`#embed>`の機能追加はいらないかも
            - 低優先度で何もしないようなタスクを用意しておいて、別のものを埋め込みたいときに再定義すればいいため
    - [x] debugモードの追加
        - タスクの展開を表示するようにする
    - [x] bugfix: taskやfuncの埋め込み時にconfig onceでスクリプトが削除されたとき、空の場合にエラーが返るのを対処
        - shの場合は`:`
        - pwshの場合は`? .`
    - xxx
    - [x] bugfix: taskset/read packageのReadFileでホームディレクトリ`~`を変換してなかったのを修正
    - [x] `weak`属性を追加する
        - GetPriority()関数で`priority:Min-1`を出す
        - `priority`属性に優先する
    - [x] 位置パラメータの設定に`{?}`, `<?>`モード追加
        - Optionalなモード
    - [x] エラーに関する出力が標準出力の方に出されてしまっていたので、標準エラー出力に出るように修正する
- v0.7.0以降
    - [ ] macでの動作確認
    - [ ] win及びmacでの動作検証テスト
        - SampleTaskfilesのタスクをまとめて実行するタスクを用意する(bash/pwsh版双方)
    - [ ] simple-helpモードの搭載
        - 現時点でdefault無しで何もタスクを指定しないorタスク名をhelpとすることでタスクヘルプを見ることができる
        - 
    - [] 標準エラー出力も消す強いQuietモード
        - 出力を捨てれば良いので実装不要
    - [x] taskの@モードを除去する(config onceとの兼ね合いでバグが出そうなため)
    - [x] powershellでも`#task>`を実装する
        - スクリプトブロックを使用する

